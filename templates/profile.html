{% extends "base.html" %}

{% block content %}

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ" crossorigin="anonymous">

<script>
    window.onload = () => {
        var user = {{ user | tojson }};

        //gender population
        gender = document.getElementById("gender");
        genderOption = gender.querySelector(`option[value='${user.gender}']`);
        genderOption.selected=true;

        allergenCategory = user.allergenCategory;
        checkboxes = $("input[name='allergens']")
        for (var checkbox of checkboxes) {
            if (allergenCategory.includes(checkbox.value))
                checkbox.checked=true;
        }
        otherAllergen = $("#otherAllergen");
        otherAllergenList = user.finalAllergenList.pop()
        otherAllergen.val(otherAllergenList);

    }

</script>

<style>
    body{
    background: #f7f7ff;
    margin-top:20px;
}
.card {
    position: relative;
    display: flex;
    flex-direction: column;
    min-width: 0;
    word-wrap: break-word;
    background-color: #fff;
    background-clip: border-box;
    border: 0 solid transparent;
    border-radius: .25rem;
    margin-bottom: 1.5rem;
    box-shadow: 0 2px 6px 0 rgb(218 218 253 / 65%), 0 2px 6px 0 rgb(206 206 238 / 54%);
}
.me-2 {
    margin-right: .5rem!important;
}
</style>

<div class="container">
    <div class="main-body">
        <div class="row">
            <div class="col-lg-4">
                <div class="card">
                    <div class="card-body">
                        <div class="d-flex flex-column align-items-center text-center">
                            <img src="https://dubaidentalhospital.ae/en/Img/Avatar-Icon.png" alt="Admin" class="rounded-circle p-1 border" width="110">
                        </div>
                        <hr class="my-4">
                        <h5 class="d-flex justify-content-between align-items-center" style="justify-content: center !important;">Details of Each Allergy Category</h5>
                        <hr class="my-4">
                        <ul class="list-group list-group-flush">
                            <li class="list-group-item d-flex justify-content-between align-items-center flex-wrap">
                                <h6 class="mb-0">Gluten</h6>
                                <span class="text-secondary">Wheat, Barley, Rye</span>
                            </li>
                            <li class="list-group-item d-flex justify-content-between align-items-center flex-wrap">
                                <h6 class="mb-0">Dairy</h6>
                                <span class="text-secondary">Milk, Cheese, Yoghurt</span>
                            </li>
                            <li class="list-group-item d-flex justify-content-between align-items-center flex-wrap">
                                <h6 class="mb-0">Nut</h6>
                                <span class="text-secondary">Almonds, Peanuts, Walnuts</span>
                            </li>
                            <li class="list-group-item d-flex justify-content-between align-items-center flex-wrap">
                                <h6 class="mb-0">Soy</h6>
                                <span class="text-secondary">Tofu, Soy Milk, Soy Sauce</span>
                            </li>
                            <li class="list-group-item d-flex justify-content-between align-items-center flex-wrap">
                                <h6 class="mb-0">Meat-Based</h6>
                                <span class="text-secondary">Fish, Chicken, Eggs, Mutton</span>
                            </li>
                            <li class="list-group-item d-flex justify-content-between align-items-center flex-wrap">
                                <h6 class="mb-0">Fruit-Based</h6>
                                <span class="text-secondary">Pineapple, Lemons, Plums</span>
                            </li>
                            <li class="list-group-item d-flex justify-content-between align-items-center flex-wrap">
                                <h6 class="mb-0">Cruciferous</h6>
                                <span class="text-secondary">Broccoli, Spinach, Celery</span>
                            </li>
                        </ul>
                        <hr class="my-4">
                        <div class="row">
                            <div class="col-sm-9 text-secondary" style="text-align: left;">
                                <a href="{{ url_for('logout') }}" class="btn btn-dark px-4">Log Out</a>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
            <div class="col-lg-8">
                <form action="{{ url_for('update_profile') }}" method="POST">
                    <div class="card">
                        <div class="card-body">
                            <div class="row mb-3">
                                <div class="col-sm-3">
                                    <h6 class="mb-0">Full Name</h6>
                                </div>
                                <div class="col-sm-9 text-secondary">
                                    <input type="text" class="form-control" value="{{ user.fullName }}" name="fullname" required>
                                </div>
                            </div>
                            <div class="row mb-3">
                                <div class="col-sm-3">
                                    <h6 class="mb-0">Email</h6>
                                </div>
                                <div class="col-sm-9 text-secondary">
                                    <input type="email" class="form-control" value="{{ user.email }}" name="email" required>
                                </div>
                            </div>
                            <div class="row mb-3">
                                <div class="col-sm-3">
                                    <h6 class="mb-0">Mobile</h6>
                                </div>
                                <div class="col-sm-9 text-secondary">
                                    <input type="text" class="form-control" value="{{ user.mobile }}" name="mobileNo" required>
                                </div>
                            </div>
                            <div class="row mb-3">
                                <div class="col-sm-3">
                                    <h6 class="mb-0">Gender</h6>
                                </div>
                                <div class="col-sm-9 text-secondary">
                                    <select class="form-control" id="gender" name="gender">
                                        <option value="">-- Select an option --</option>
                                        <option value="male">Male</option>
                                        <option value="female">Female</option>
                                        <option value="other">Prefer not to say</option>
                                    </select>
                                </div>
                            </div>
                            <div class="row mb-3">
                                <div class="col-sm-3">
                                    <h6 class="mb-0">Age</h6>
                                </div>
                                <div class="col-sm-9 text-secondary">
                                    <input type="number" class="form-control" value="{{ user.age }}" min = 0 name="age">
                                </div>
                            </div>
                            <div class="row mb-3">
                                <div class="col-sm-3">
                                    <h6 class="mb-0">Allergen Category</h6>
                                </div>
                                <div class="col-sm-9 text-secondary">
                                    <div class="row">
                                        <div class="col-md-6">
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" name="allergens" value="Gluten" id="checkbox1">
                                                <label class="form-check-label" for="checkbox1">
                                                    Gluten
                                                </label>
                                            </div>
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" name="allergens" value="Dairy" id="checkbox2">
                                                <label class="form-check-label" for="checkbox2">
                                                    Dairy
                                                </label>
                                            </div>
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" name="allergens" value="Nut" id="checkbox3">
                                                <label class="form-check-label" for="checkbox3">
                                                    Nut
                                                </label>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" name="allergens" value="Soy" id="checkbox4">
                                                <label class="form-check-label" for="checkbox4">
                                                    Soy
                                                </label>
                                            </div>
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" name="allergens" value="Meat Based" id="checkbox5">
                                                <label class="form-check-label" for="checkbox5">
                                                    Meat Based
                                                </label>
                                            </div>
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" name="allergens" value="Fruit Based" id="checkbox6">
                                                <label class="form-check-label" for="checkbox6">
                                                    Fruit Based
                                                </label>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" name="allergens" value="Cruciferous" id="checkbox4">
                                                <label class="form-check-label" for="checkbox4">
                                                    Cruciferous
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row mb-3">
                                <div class="col-sm-3">
                                    <h6 class="mb-0">Other Allergens</h6>
                                </div>
                                <div class="col-sm-9 text-secondary">
                                    <input type="text" id="otherAllergen" class="form-control" min = 0 name="otherAllergen">
                                </div>
                            </div>

                            <div class="row">
                                <div class="col-sm-3"></div>
                                <div class="col-sm-9 text-secondary" style="text-align: center;">
                                    <input type="submit" class="btn btn-primary px-4" value="Save Changes">
                                </div>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

{% endblock %}